#### 1. 背景介绍
- 互联网是Cache为王的时代，为什么会非常的重视Cache的原因，在于互联网是极大的减少了万物连接的成本。而Cache的设计是极大的提升了互联网的执行效率，从而加快了互联网的覆盖的效率。 

#### 2. 缓存的机制/工作原理
缓存的机制要从计算机的组成来看， 存储器主要是为CPU提供服务，但是CPU的执行频率远高于存储器，而存储器里面不同的介质传输速率是不一样的。 存储器分为，辅助（硬盘），主存（内存，高速缓存 RAM）,但是提高CPU的使用效率，高速缓存使用的越充分，那么执行性能就越高。 CPU在执行指令的时候，会先检查高速缓存中是否有内容，没有才去内存中去处理。所以，缓存的机制主要是把一些经常使用的内容放到高速缓存区，提高CPU对高速缓存/内存的命中率。 提高整体的执行速度。

PS:
CPU的处理速度和内存的访问速度差距越来越大，甚至可以达到上万倍。

##### 2.2 表现形式  
- 把结果集生成起来，方便下次使用
- 把辅助存储提前加载到主存，提高加载的速度


#### 3. Buffer 缓冲 & 和缓存的区别
缓冲（buffers）是根据磁盘的读写设计的。主要是用于磁盘的读写。 在磁盘的读写的时候，把把打开的输入流加载到缓冲区，然后写入流在缓冲器去读取操作。 
缓存侧重于辅助存储(磁盘)加载到与主存的过程中,方便高速缓存/寄存器的快速读取。提高cpu的处理效果,较少cpu等待的消耗。 

#### 4. CPU Cache 是如何管理的?
> Cache 如果是在我们系统的开发的时候其实是可以使用hash数值的形式，但是考虑到高速缓存的容量大小，大概4m左右，不同的机器不一样。 这样如果Hash耗费大概1w倍CPU频率，这样带来的消耗是性能不够高的情况。 所以需要考虑采用指针链的方式，分为三层，搞错

##### 4.1 Cache淘汰策略
淘汰的算法：常见的淘汰策略主要有LRU
-  LRU是Least Recently Used， 操作系统会通过页面置换的算法对存储进行管理，会对于很少使用的内存块移出来，放到指定的内存区域。 
具体的执行过程可以看截图:
    1. 对于每个进入缓存的元素都记录get数量
    2. 当缓存put容量超过设置最大的容量值时候,就把get次数最少的进行移出。 
![](https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1514979307797&di=b1f2f3b55a0170a020b22ff11a4e33b2&imgtype=0&src=http%3A%2F%2Fimages.cnitblog.com%2Fi%2F221914%2F201407%2F032243438405423.png)

##### 4.2 Cache的内存申请算法
> Cache 申请内存的方法跟操作系统内存管理方法类似,主要使用slab管理的方式:
- 每个slab包含若干大小为1M的内存页，这些内存又被分割成多个chunk，每个chunk存储一个item；
- 在Cache启动初始化时，每个slab都预分配一个内存页,如1M
![](http://blog.itpub.net/attachment/201501/31/15480802_14227156073VAU.png)




#### 5. 缓存中日常的实现
##### 5.1 缓存的常用接口
> 缓存的管理： get, put , delete  (CRUD), 

##### 5.2 Cache常见的类型
- 数组缓存
- 文件缓存
- 数据库缓存
- 还有就是Redis,memcached基于内存的缓存 

#### 6. 缓存的单元测试
##### 6.1 基本数组的缓存增删改查的测试
- 检查设置的缓存是否可以被查询到
- 设置多个缓存是否可以被查到
- 测试缓存数值计算，增加和减少
- 测试缓存的删除是否有变化
- 测试缓存全部删除是否正常执行

##### 6.2 文件系统的缓存
> 文件的缓存就是把文件的路径作为缓存的key,并自动创建目录文件。而缓存的内容主要是包含缓存失效的时间和缓存的内容。 

- 文件不存在
- 目录不存在
- 缓存过期
- 返回的内容是否合法
- 测试文件是否存在过期
- 删除文件后会提示文件不存在
- 测试删除文件
- 清空文件目录
- 空间文件目录失败
- 对于不存在的目录执行清空失败

